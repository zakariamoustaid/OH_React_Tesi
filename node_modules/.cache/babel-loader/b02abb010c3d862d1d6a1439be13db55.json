{"ast":null,"code":"import produce from \"immer\";\nimport set from \"lodash.set\";\nimport { AUTH_KEY } from \"../../consts\";\nimport { SessionStorage } from \"../storage/storage\";\nexport const applyTokenMiddleware = {\n  pre(request) {\n    return produce(request, draft => {\n      const userCredentials = SessionStorage.read(AUTH_KEY);\n\n      if (userCredentials.token) {\n        draft.headers = set(draft.headers || {}, \"Authorization\", `Bearer ${userCredentials.token}`);\n      }\n    });\n  }\n\n};","map":{"version":3,"sources":["/home/zak/projects/OH_R/openhospital-ui/src/libraries/apiUtils/applyTokenMiddleware.ts"],"names":["produce","set","AUTH_KEY","SessionStorage","applyTokenMiddleware","pre","request","draft","userCredentials","read","token","headers"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,OAApB;AACA,OAAOC,GAAP,MAAgB,YAAhB;AACA,SAASC,QAAT,QAAyB,cAAzB;AAEA,SAASC,cAAT,QAA+B,oBAA/B;AAEA,OAAO,MAAMC,oBAAgC,GAAG;AAC9CC,EAAAA,GAAG,CAACC,OAAD,EAAoC;AACrC,WAAON,OAAO,CAACM,OAAD,EAAWC,KAAD,IAAW;AACjC,YAAMC,eAAe,GAAGL,cAAc,CAACM,IAAf,CAAoBP,QAApB,CAAxB;;AACA,UAAIM,eAAe,CAACE,KAApB,EAA2B;AACzBH,QAAAA,KAAK,CAACI,OAAN,GAAgBV,GAAG,CACjBM,KAAK,CAACI,OAAN,IAAiB,EADA,EAEjB,eAFiB,EAGhB,UAASH,eAAe,CAACE,KAAM,EAHf,CAAnB;AAKD;AACF,KATa,CAAd;AAUD;;AAZ6C,CAAzC","sourcesContent":["import produce from \"immer\";\nimport set from \"lodash.set\";\nimport { AUTH_KEY } from \"../../consts\";\nimport { Middleware, RequestArgs } from \"../../generated\";\nimport { SessionStorage } from \"../storage/storage\";\n\nexport const applyTokenMiddleware: Middleware = {\n  pre(request: RequestArgs): RequestArgs {\n    return produce(request, (draft) => {\n      const userCredentials = SessionStorage.read(AUTH_KEY);\n      if (userCredentials.token) {\n        draft.headers = set(\n          draft.headers || {},\n          \"Authorization\",\n          `Bearer ${userCredentials.token}`\n        );\n      }\n    });\n  },\n};\n"]},"metadata":{},"sourceType":"module"}